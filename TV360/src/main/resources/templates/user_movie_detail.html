<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">

<head th:replace="user_fragments::head"></head>

<body>
<!-- header Start -->
<header th:replace="user_fragments::header" class="header" data-header></header>
<!-- header End -->

<main>
    <article>
        <!-- content-->
        <section class="movie-detail">
            <div class="container">
                <figure class="movie-detail-banner">
                    <img alt="Free guy movie poster" style="max-width: 450px; max-height: 450px" th:src="@{${firstMediaDetail.thumbnail}}">

                    <button class="play-btn">
                        <ion-icon name="play-circle-outline"></ion-icon>
                    </button>

                </figure>

                <div class="movie-detail-content">
                    <div class="badge-wrapper">
                        <p class="badge badge-outline" style="margin: 0 10px 10px 0" th:text="${firstMediaDetail.quality}"></p>
                        <p class="detail-subtitle"
                           th:text="${firstMediaDetail.episode == null ? '' : ('Episode ' + firstMediaDetail.episode)}"></p>
                    </div>

                    <h3 class="h2 detail-title" th:text="${firstMediaDetail.title}"></h3>

<!--                    chua fix chua lay duoc category id-->
                    <div class="meta-wrapper">
                        <div class="ganre-wrapper">
                            <h4 style="color:var(--citrine); font-weight: bold">Category:</h4>
                                <a th:each="category, iterStat : ${firstMediaDetail.listCategoryNames}"
                                th:text="${category + (iterStat.last ? '' : ', ')}"
                                th:href="@{'/media/by-category/' + id}"></a>

                        </div>

                        <div class="ganre-wrapper">
                            <h4 style="color:var(--citrine); font-weight: bold">Director:</h4>
                            <a th:each="director, iterStat : ${firstMediaDetail.listCastFullNames}"
                               th:if="${firstMediaDetail.listCastTypes.contains(1)}"
                               th:text="${director + (iterStat.last ? '' : ', ')}"></a>
                        </div>

                        <div class="ganre-wrapper">
                            <h4 style="color:var(--citrine); font-weight: bold">Actor:</h4>
                            <a th:each="actor, iterStat : ${firstMediaDetail.listCastFullNames}"
                               th:if="${firstMediaDetail.listCastTypes.contains(2)}"
                               th:text="${actor + (iterStat.last ? '' : ', ')}"></a>
                        </div>


                        <div class="date-time">
                            <div style="font-size: 14px">
                                <ion-icon name="earth-outline"></ion-icon>

                                <span th:text="${firstMediaDetail.countryName}"/>
                            </div>

                            <div style="font-size: 15px">
                                <ion-icon name="time-outline"></ion-icon>

                                <time th:text="${firstMediaDetail.duration}"></time>
                            </div>
                        </div>
                    </div>

                    <p th:text="${firstMediaDetail.mediaDescription}" class="storyline"/>

                    <div class="details-actions">

                        <button class="share">
                            <ion-icon name="share-social"></ion-icon>

                            <span>Share</span>
                        </button>

                        <div class="title-wrapper">
                            <p class="title">Prime Video</p>

                            <p class="text">Streaming Channels</p>
                        </div>

                        <button class="btn btn-primary">
                            <ion-icon name="play"></ion-icon>

                            <span>Watch Now</span>
                        </button>

                    </div>

                    <a href=".././static/user/assets/images/movie-4.png" download class="download-btn">
                        <span>Download</span>

                        <ion-icon name="download-outline"></ion-icon>
                    </a>
                </div>
            </div>
        </section>

        <!-- end content-->
        <section class="top-rated tv-series" style="padding-top: 50px; padding-bottom: 150px">
            <div class="container">

                <p class="section-subtitle">Coming soon</p>

                <h2 class="h2 section-title">Related information</h2>

                <ul class="filter-list">
                    <li>
                        <button class="filter-btn" onclick="changeTabTopRate('moviesRateTab', this)">Episodes</button>
                    </li>

                    <li>
                        <button class="filter-btn" onclick="changeTabTopRate('videosRateTab', this)">Similar</button>
                    </li>

                </ul>

                <!--Episodes-->
                <ul class="movies-list movies-rate-tab">
                    <li>
                        <div class="movie-card">

                            <a href="./movie-details.html">
                                <figure class="card-banner">
                                    <img src="./assets/images/upcoming-1.png" alt="The Northman movie poster">
                                </figure>
                            </a>

                            <div class="title-wrapper">
                                <a href="./movie-details.html">
                                    <h3 class="card-title">The Northman</h3>
                                </a>

                                <div class="badge badge-outline">HD</div>
                            </div>

                            <div class="card-meta">
                                <div class="duration">
                                    <ion-icon name="time-outline"></ion-icon>

                                    <time datetime="PT137M">137 min</time>
                                </div>

                                <div class="rating">
                                    <ion-icon name="star"></ion-icon>

                                    <data>8.5</data>
                                </div>
                            </div>

                        </div>
                    </li>

                    <li>
                        <div class="movie-card">

                            <a href="./movie-details.html">
                                <figure class="card-banner">
                                    <img src="./assets/images/upcoming-1.png" alt="The Northman movie poster">
                                </figure>
                            </a>

                            <div class="title-wrapper">
                                <a href="./movie-details.html">
                                    <h3 class="card-title">The Northman</h3>
                                </a>

                                <div class="badge badge-outline">HD</div>
                            </div>

                            <div class="card-meta">
                                <div class="duration">
                                    <ion-icon name="time-outline"></ion-icon>

                                    <time datetime="PT137M">137 min</time>
                                </div>

                                <div class="rating">
                                    <ion-icon name="star"></ion-icon>

                                    <data>8.5</data>
                                </div>
                            </div>

                        </div>
                    </li>

                </ul>

                <!--Similar-->
                <ul class="videos-list videos-rate-tab">
                    <li>
                        <div class="movie-card">

                            <a href="./movie-details.html">
                                <figure class="card-banner">
                                    <img src="./assets/images/upcoming-1.png" alt="The Northman movie poster">
                                </figure>
                            </a>

                            <div class="title-wrapper">
                                <a href="./movie-details.html">
                                    <h3 class="card-title">The Northman</h3>
                                </a>

                                <div class="badge badge-outline">HD</div>
                            </div>

                            <div class="card-meta">
                                <div class="duration">
                                    <ion-icon name="time-outline"></ion-icon>

                                    <time datetime="PT137M">137 min</time>
                                </div>

                                <div class="rating">
                                    <ion-icon name="star"></ion-icon>

                                    <data>8.5</data>
                                </div>
                            </div>

                        </div>
                    </li>

                    <li>
                        <div class="movie-card">

                            <a href="./movie-details.html">
                                <figure class="card-banner">
                                    <img src="./assets/images/upcoming-1.png" alt="The Northman movie poster">
                                </figure>
                            </a>

                            <div class="title-wrapper">
                                <a href="./movie-details.html">
                                    <h3 class="card-title">The Northman</h3>
                                </a>

                                <div class="badge badge-outline">HD</div>
                            </div>

                            <div class="card-meta">
                                <div class="duration">
                                    <ion-icon name="time-outline"></ion-icon>

                                    <time datetime="PT137M">137 min</time>
                                </div>

                                <div class="rating">
                                    <ion-icon name="star"></ion-icon>

                                    <data>8.5</data>
                                </div>
                            </div>

                        </div>
                    </li>
                </ul>


                <section class="upcoming" style="padding: 5vh 0;"
                         th:each="category : ${categoriesWithMovie}"
                         th:if="${category.getType() == 1}">
                    <div class="container">
                        <div class="flex-wrapper">
                            <div class="title-wrapper">
                                <p class="section-subtitle">Online Streaming</p>

                                <h2 class="h2 section-title" th:text="${category.getName()}"></h2>
                            </div>
                            <a th:href="@{'/media/by-category/' + ${category.id}}">
                                <p class="view-all-category">View all > </p>
                            </a>
                        </div>

                        <ul class="movies-list has-scrollbar">
                            <li th:each="media : ${category.media}">
                                <div class="movie-card">

                                    <a th:href="@{/movie/detail/{mediaId} (mediaId=${media.id})}">
                                        <!--                            <a th:href="@{/movie/detail/{mediaId}/{mdId} (mediaId=${media.id}, mdId=${releaseMediaList.media.id})}">-->
                                        <figure class="card-banner">
                                            <img th:src="${media.getThumbnail()}">
                                        </figure>
                                    </a>

                                    <div class="title-wrapper">
                                        <a th:href="@{/movie/detail/{mediaId} (mediaId=${media.id})}">
                                            <h3 class="card-title align-content-center" th:text="${media.getTitle()}"></h3>
                                        </a>
                                    </div>
                                </div>
                            </li>
                        </ul>
                    </div>
                </section>
            </div>
        </section>
        <!-- contact -->
        <section class="cta" th:replace="user_fragments::contact"></section>
    </article>
</main>

<footer class="footer" th:replace="user_fragments::footer"></footer>

<a th:replace="user_fragments::back-to-top"></a>

<div th:replace="user_fragments::script"></div>

<script>
    function changeTabNewRelease(tabId, button) {
        var buttons = document.querySelectorAll('.filter-btn');
        buttons.forEach(function(btn) {
            btn.classList.remove('active');
        });

        button.classList.add('active');

        var movieList = document.querySelector('.movies-release-tab');
        var videoList = document.querySelector('.videos-release-tab');

        if (tabId === 'moviesReleaseTab') {
            movieList.style.display = 'flex';
            videoList.style.display = 'none';
        } else if (tabId === 'videosReleaseTab') {
            movieList.style.display = 'none';
            videoList.style.display = 'flex';
        }
    }
</script>

<script>
    function changeTabTopRate(tabId, button) {
        var buttons = document.querySelectorAll('.filter-btn');
        buttons.forEach(function(btn) {
            btn.classList.remove('active');
        });

        button.classList.add('active');

        var movieList = document.querySelector('.movies-rate-tab');
        var videoList = document.querySelector('.videos-rate-tab');

        if (tabId === 'moviesRateTab') {
            movieList.style.display = 'grid';
            videoList.style.display = 'none';
        } else if (tabId === 'videosRateTab') {
            movieList.style.display = 'none';
            videoList.style.display = 'grid';
        }
    }
</script>

</body>

</html>
