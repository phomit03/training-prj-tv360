<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">

<head th:replace="admin_fragments::head"></head>

<body>
<!-- navbar Start -->
<div th:replace="admin_fragments::navbar"></div>
<!-- navbar End -->

<div id="layoutSidenav">
  <!-- menu Start -->
  <div id="layoutSidenav_nav" th:replace="admin_fragments::menu"></div>
  <!-- menu End -->

  <div id="layoutSidenav_content">
    <!-- Content Start -->
    <main>
      <div class="container-fluid px-4">
        <h1 class="mt-4 title-admin">Media Categories</h1>
        <div class="card mb-4">
          <div class="card-header">
            <i class="fas fa-table me-1"></i>
            List of media categories

              <a th:href="@{/admin/media-category/create}">
                <button type="button" class="btn btn-primary" style="float: right">+ media category</button>
              </a>

            </div>
            <div class="card-body">
              <table id="datatablesSimple">
                <thead>
                  <tr>
                    <th>#</th>
                    <th>Type Media</th>
                    <th>Name Category</th>
                    <th>Status</th>
                    <th>Action</th>
                  </tr>
                </thead>
                <tbody th:if="${mediaCategories != null and #lists.size(mediaCategories) > 0}">
                  <tr th:each="mediaCategory, iterStat : ${mediaCategories}" th:class="'media-category-' + ${mediaCategory.id}">
                      <td th:text="${iterStat.index + 1}"></td>
                      <td th:text="${mediaCategory.media.type}"></td>
                      <td th:text="${mediaCategory.category.name}"></td>
                      <td>
                        <span style="color: green">
                          <th:block th:if="${mediaCategory.status == 1}">
                            active
                          </th:block>
                        </span>
                        <span style="color: red">
                          <th:block th:if="${mediaCategory.status == 0}">
                            in-active
                          </th:block>
                        </span>
                      </td>
                      <td>
                        <button class="btn">
                          <a th:href="@{/admin/media-category/update/{id} (id=${mediaCategory.id})}">
                            <i class="fas fa-pencil-alt"></i>
                          </a>
                        </button>
                        <th:block th:if="${mediaCategory.status == 1}">
                          <button type="button" th:data-id="${mediaCategory.id}" class="btn delete-btn">
                            <i class="fas fa-trash"></i>
                          </button>
                        </th:block>
                      </td>
                  </tr>
                </tbody>
              </table>
            </div>
        </div>
      </div>
    </main>
    <!-- Content End -->

    <!-- footer Start -->
    <footer th:replace="admin_fragments::footer" class="py-4 bg-light mt-auto"></footer>
    <!-- footer End -->
  </div>
</div>

<script>
  $(document).ready(function () {
    $('.delete-btn').click(function () {
      var id = $(this).data('id');
      var newRow = $('.media-category-' + id);
      Swal.fire({
        title: 'Are you sure you want to delete this item?',
        text: "You won't be able to revert this!",
        icon: 'warning',
        showCancelButton: true,
        confirmButtonColor: '#3085d6',
        cancelButtonColor: '#d33',
        confirmButtonText: 'Yes, delete it!'
      }).then((result) => {
        if (result.isConfirmed) {
          $.ajax({
            url: "/admin/media-category/delete/" + id,
            success: function () {
              newRow.remove();
              Swal.fire(
                      'Success',
                      'Delete success',
                      'success'
              ).then(() => {
                location.reload();
              });
            }
          })
        }
      })
    })
  })
</script>

<div th:replace="admin_fragments::script"></div>
</body>

</html>
